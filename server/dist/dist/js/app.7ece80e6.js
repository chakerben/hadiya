(function(){var e={5176:function(e,r,t){"use strict";var n=t(5130),o=t(6768);function a(e,r,t,n,a,s){const i=(0,o.g2)("router-view");return(0,o.uX)(),(0,o.Wv)(i)}var s={name:"App"},i=t(1241);const u=(0,i.A)(s,[["render",a]]);var c=u,l=t(1387),d=t(4232);const m=e=>((0,o.Qi)("data-v-0a9df7c3"),e=e(),(0,o.jt)(),e),p={class:"form-container"},h=m((()=>(0,o.Lk)("h1",null,"تقديم النموذج",-1))),f=m((()=>(0,o.Lk)("label",null,"الاسم:",-1))),b={key:0,class:"error"},g=m((()=>(0,o.Lk)("label",null,"رقم الهاتف:",-1))),v={key:1,class:"error"},y=m((()=>(0,o.Lk)("button",{type:"submit"},"إرسال",-1))),k={key:2,class:"error"};function E(e,r,t,a,s,i){return(0,o.uX)(),(0,o.CE)("div",p,[h,(0,o.Lk)("form",{onSubmit:r[2]||(r[2]=(0,n.D$)(((...e)=>i.submitForm&&i.submitForm(...e)),["prevent"])),class:"form"},[f,(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":r[0]||(r[0]=e=>s.name=e),required:""},null,512),[[n.Jo,s.name]]),s.errors.name?((0,o.uX)(),(0,o.CE)("span",b,(0,d.v_)(s.errors.name),1)):(0,o.Q3)("",!0),g,(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":r[1]||(r[1]=e=>s.phoneNumber=e),required:""},null,512),[[n.Jo,s.phoneNumber]]),s.errors.phoneNumber?((0,o.uX)(),(0,o.CE)("span",v,(0,d.v_)(s.errors.phoneNumber),1)):(0,o.Q3)("",!0),y,s.formError?((0,o.uX)(),(0,o.CE)("span",k,(0,d.v_)(s.formError),1)):(0,o.Q3)("",!0)],32)])}var w=t(8355);const L="https://hadiya-758606f67f4d.herokuapp.com";var A={data(){return{name:"",phoneNumber:"",errors:{},formError:""}},methods:{async submitForm(){if(this.errors={},this.formError="",this.name||(this.errors.name="الرجاء إدخال الاسم"),this.phoneNumber||(this.errors.phoneNumber="الرجاء إدخال رقم الهاتف"),!(Object.keys(this.errors).length>0))try{await w.A.post(`${L}/api/forms`,{name:this.name,phoneNumber:this.phoneNumber}),alert("تم إرسال النموذج بنجاح!"),this.name="",this.phoneNumber=""}catch(e){console.log("error",e.message),this.formError="حدث خطأ أثناء إرسال النموذج. الرجاء المحاولة مرة أخرى."}}}};const N=(0,i.A)(A,[["render",E],["__scopeId","data-v-0a9df7c3"]]);var _=N;const O=e=>((0,o.Qi)("data-v-621bdea4"),e=e(),(0,o.jt)(),e),j={class:"admin-container"},q=O((()=>(0,o.Lk)("h1",null,"لوحة التحكم",-1)));function C(e,r,t,n,a,s){const i=(0,o.g2)("ag-grid-vue");return(0,o.uX)(),(0,o.CE)("div",j,[q,(0,o.bF)(i,{columnDefs:a.columnDefs,rowData:a.requests,style:{height:"500px"},class:"ag-theme-quartz",enableRtl:!0},null,8,["columnDefs","rowData"])])}var P=t(3505),D=t(9122),S=t.n(D),$={components:{AgGridVue:P.b},data(){return{requests:[],columnDefs:[{field:"name",headerName:"الاسم",sortable:!0},{field:"phoneNumber",headerName:"رقم الهاتف",sortable:!0},{headerName:"التصرف",cellRenderer:e=>{if(null!==e.data?._id){const r=document.createElement("div");return r.classList.add("copy-icon-container"),r.innerHTML="\n                  <button>التقاط صورة</button>\n            ",this.addClickEventListener(r,e.data),r}return""},width:150},{headerName:"الصورة",cellRenderer:e=>{if(e.data?.urlPicture){const r=document.createElement("div");return r.classList.add("copy-icon-container"),r.innerHTML=`\n                  <a href="${L}/api/admin/picture/${e.data?._id}" target="_blank">فتح الصورة</button>`,r}return""}}]}},methods:{async takePhoto(e){const r=e?._id,t=e?.phoneNumber;try{const e=document.createElement("input");e.type="file",e.accept="image/*",e.capture="environment",e.addEventListener("change",(async e=>{const n=e.target.files[0];if(n){const e=new FileReader;e.readAsDataURL(n),e.onload=async()=>{const n=e.result,o=await w.A.post(`${L}/api/admin/uploadPhoto`,{imageData:n,orderId:r}),a=o.data?.imageUrl;console.log("imageUrl",a),await this.sendPicture(a,t),alert("Photo enregistrée avec succès !")}}})),e.click()}catch(n){console.error("Erreur lors de la prise de la photo :",n)}},addClickEventListener(e,r){e.addEventListener("click",(()=>this.takePhoto(r)))},async fetchRequests(){const e=await w.A.get(`${L}/api/admin/requests`);console.log("response",e),this.requests=e.data},async sendPicture(e,r){console.log("url",e);var t=S().stringify({token:"j290mey56mbdrzo3",to:r,image:e,caption:"اهداء"});console.log("phoneNumber",r);var n={method:"post",url:"https://api.ultramsg.com/instance81883/messages/image",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:t};(0,w.A)(n).then((function(e){console.log(JSON.stringify(e.data)),alert("تم التقاط الصورة وإرسالها إلى رقم الواتساب!")})).catch((function(e){console.log(e)}))}},mounted(){this.fetchRequests()}};const x=(0,i.A)($,[["render",C],["__scopeId","data-v-621bdea4"]]);var X=x;const F=e=>((0,o.Qi)("data-v-1e1c2ae8"),e=e(),(0,o.jt)(),e),Q={class:"login-container"},R=F((()=>(0,o.Lk)("h1",null,"تسجيل الدخول",-1))),T=F((()=>(0,o.Lk)("label",null,"اسم المستخدم:",-1))),U=F((()=>(0,o.Lk)("label",null,"كلمة المرور:",-1))),I=F((()=>(0,o.Lk)("button",{type:"submit"},"تسجيل الدخول",-1))),J={key:0,class:"error"};function M(e,r,t,a,s,i){return(0,o.uX)(),(0,o.CE)("div",Q,[R,(0,o.Lk)("form",{onSubmit:r[2]||(r[2]=(0,n.D$)(((...e)=>i.login&&i.login(...e)),["prevent"])),class:"login-form"},[T,(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=e=>s.username=e),required:""},null,512),[[n.Jo,s.username]]),U,(0,o.bo)((0,o.Lk)("input",{type:"password","onUpdate:modelValue":r[1]||(r[1]=e=>s.password=e),required:""},null,512),[[n.Jo,s.password]]),I,s.loginError?((0,o.uX)(),(0,o.CE)("span",J,(0,d.v_)(s.loginError),1)):(0,o.Q3)("",!0)],32)])}t(4114);var V={data(){return{username:"",password:"",loginError:""}},methods:{async login(){try{const e=await w.A.post(`${L}/api/admin/login`,{username:this.username,password:this.password});console.log("response",e),localStorage.setItem("isAuthenticated",!0),this.$router.push({name:"Admin"})}catch(e){e.response&&401===e.response.status?this.loginError="اسم المستخدم أو كلمة المرور غير صحيحة. الرجاء المحاولة مرة أخرى.":this.loginError="حدث خطأ أثناء عملية تسجيل الدخول. الرجاء المحاولة مرة أخرى لاحقًا."}}}};const z=(0,i.A)(V,[["render",M],["__scopeId","data-v-1e1c2ae8"]]);var H=z;const G=[{path:"/",name:"Form",component:_},{path:"/admin",name:"Admin",component:X,meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:H}],W=(0,l.aE)({history:(0,l.LA)(),routes:G});W.beforeEach(((e,r,t)=>{const n=localStorage.getItem("isAuthenticated");e.matched.some((e=>e.meta.requiresAuth))?n?t():t({name:"Login"}):t()}));var B=W;(0,n.Ef)(c).mount("#app");const K=(0,n.Ef)(c);K.use(B),K.mount("#app")},2634:function(){}},r={};function t(n){var o=r[n];if(void 0!==o)return o.exports;var a=r[n]={exports:{}};return e[n].call(a.exports,a,a.exports,t),a.exports}t.m=e,function(){var e=[];t.O=function(r,n,o,a){if(!n){var s=1/0;for(l=0;l<e.length;l++){n=e[l][0],o=e[l][1],a=e[l][2];for(var i=!0,u=0;u<n.length;u++)(!1&a||s>=a)&&Object.keys(t.O).every((function(e){return t.O[e](n[u])}))?n.splice(u--,1):(i=!1,a<s&&(s=a));if(i){e.splice(l--,1);var c=o();void 0!==c&&(r=c)}}return r}a=a||0;for(var l=e.length;l>0&&e[l-1][2]>a;l--)e[l]=e[l-1];e[l]=[n,o,a]}}(),function(){t.n=function(e){var r=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(r,{a:r}),r}}(),function(){t.d=function(e,r){for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};t.O.j=function(r){return 0===e[r]};var r=function(r,n){var o,a,s=n[0],i=n[1],u=n[2],c=0;if(s.some((function(r){return 0!==e[r]}))){for(o in i)t.o(i,o)&&(t.m[o]=i[o]);if(u)var l=u(t)}for(r&&r(n);c<s.length;c++)a=s[c],t.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return t.O(l)},n=self["webpackChunkfront"]=self["webpackChunkfront"]||[];n.forEach(r.bind(null,0)),n.push=r.bind(null,n.push.bind(n))}();var n=t.O(void 0,[504],(function(){return t(5176)}));n=t.O(n)})();
//# sourceMappingURL=app.7ece80e6.js.map